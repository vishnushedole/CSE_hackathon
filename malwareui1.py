import hashlib
import mysql.connector
import os.path

import signBasedMD

from tkinter import *

from tkinter import filedialog

import tkinter.font as font

import os


# import signBasedMD

filePath = ""
no_of_malicious_files = 0
# Function for opening the
# file explorer window
def browseFiles():
	filename = filedialog.askopenfilename(initialdir = "/",
										title = "Select a File",
										filetypes = (("Text files",
														"*.txt*"),
													("all files",
														"*.*")))
	
	
	label_file_explorer.configure(text="File Opened: "+filename)
	global filePath 
	filePath = filename
	print(filePath)
	return filename

def browseFolder():
	dirname = filedialog.askdirectory(initialdir="/",title="Select a Folder")

	label_file_explorer.configure(text="Folder opened: "+dirname)
	global filePath 
	filePath = dirname
	print(filePath)
	return dirname

def deletefileorfolder():
	filename=browseFiles()
	if(os.path.isfile(filename)):
		os.remove(filename)
 


def callReadFile():
	no_of_malicious_files = signBasedMD.readFile(filePath=filePath)
	label_del = Label(frame,text="Total Malicious files found "+str(no_of_malicious_files),bg="gold",fg="black",font=comic10)
	label_del.place(x=720,y=270)

																								
# Create the root window

def deletefileorfolder():
	filename=filePath
	if(os.path.isfile(filename)):
		os.remove(filename)
		label_del = Label(frame,text="File Deleted",bg="gold",fg="black",font=comic)
		label_del.place(x=170,y=350)
		print("file deleted")
	else:
		label_inv = Label(frame,text="Invalid File",bg="gold",fg="black",font=comic)
		label_inv.place(x=170,y=350)
		print("not a file")

window = Tk()

# Set window title
window.title('Malware Detector')

# Set window size
window.geometry("1200x670")
window.resizable(False,False)

# img= PhotoImage(file="malwareimg5res.png", master= window)
# img_label= Label(window,image=img)
# img_label.place(x=0,y=0)
frame1=Frame(window, width=1200, height=670,bg="dodgerblue4")
frame1.place(x=0, y=0)

roman20 = font.Font(family="roman",size=20,weight="bold",underline=1)
courier15 = font.Font(family="courier",size=15)
arial10 = font.Font(family="arial",size=15)
comic30 = font.Font(family="Comic Sans MS",size=30)
comic = font.Font(family="Comic Sans MS",size=20)
comic10 = font.Font(family="Comic Sans MS",size=15)

frame=Frame(window, width=1000, height=500,bg="gold")
frame.place(x=100, y=100)

heading = Label(frame,text="Malware Detector",fg="black",bg="gold",font=comic30)
heading.place(x=320,y=10)

del_file_label = Label(frame,text ="Do you want to delete the selected file/folder?",font=comic10,fg="black",bg="gold")
del_file_label.place(x=100,y=300)

del_img = PhotoImage(file="del.png")
button_del = Button(frame,image=del_img,command=deletefileorfolder)
button_del.place(x=100,y=350)


label_file_explorer = Label(frame,text = "Select the file to scan:",fg = "black",bg="gold",font=comic10)
label_file_explorer.place(x=100,y=100)

label_browse = Label(frame,text="Browse File",bg="gold",fg="black",font=comic10)
label_browse.place(x=120,y=150)

browse_img = PhotoImage(file="browse.png")
button_explore = Button(frame,image=browse_img,command = browseFiles)
button_explore.place(x=75,y=150)

label_browse = Label(frame,text="Browse Folder",bg="gold",fg="black",font=comic10)
label_browse.place(x=340,y=150)

brfol_img = PhotoImage(file="brfol.png")
button_exit = Button(frame,image=brfol_img,command=browseFolder)
button_exit.place(x=275,y=150)

label_scan = Label(frame,text="Scan",bg="gold",fg="black",font=comic10)
label_scan.place(x=525,y=150)

scan_img = PhotoImage(file="scan.png")
button_scan = Button(frame,image=scan_img,command = callReadFile)
button_scan.place(x=475,y=150)

label_exit = Label(frame,text="Exit",bg="gold",fg="black",font=comic10)
label_exit.place(x=700,y=150)

exit_img = PhotoImage(file="exit.png")
button_exit = Button(frame,image=exit_img,command = exit)
button_exit.place(x=650,y=150)

label_exit = Label(frame,text="Scan Results",bg="gold",fg="black",font=comic10)
label_exit.place(x=720,y=230)

window.mainloop()
